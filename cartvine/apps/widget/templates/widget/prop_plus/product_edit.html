{% extends 'widget/widget_edit.html' %}
{% load i18n templatetag_handlebars %}
{% load url from future %}

{% block title %}{% trans 'Info for' %} {{ object.name }}{% endblock %}

{% block content-head %}
<h1>{% trans 'Properties for ' %}{{ object.name }}</h1>
{% endblock %}

{% block body %}
<div class="span5">
    <h2>{% trans 'Properties' %}</h2>
    <ul>
    {% for property in object.data.options %}
        <li>{{ property.name }}</li>
    {% empty %}
        <li>None Configured</li>
    {% endfor %}
    </ul>

    <h2>{% trans 'Custom Properties' %}</h2>

<!--     <p class="pull-right"><a class="btn btn-inverse" href="{% url 'widget:custom_config' slug=widget_slug %}">{% trans 'Add Properties' %}</a></p>
    <div clas="clearfix">&nbsp;</div> -->

    <form action="{% url 'widget:custom_apply_post' slug=widget_slug provider_pk=provider_pk %}" method="post" class="form-horizontal">{% csrf_token %}
        <label id="wrap-custom-props" for="input-new-prop"></label><div id="new-prop"></div>
<!--         {{ form.management_form }}
        {% for form_item in form %}
        {{ form_item.name }}
        <div class="control-group">
            <label class="control-label" for="{{ form_item.value.auto_id }}">{{ form_item.name.value }}</label>
            <div class="controls">
                {{ form_item.value }}
            </div>
        </div>
        {% empty %}
            {% trans 'No Properties Configured' %}
        {% endfor %}
        <div class="form-actions">
            <button type="submit" class="btn btn-primary">Save</button>
        </div> -->
    </form>

    <form action="{% url 'widget:custom_apply_post' slug=widget_slug provider_pk=provider_pk %}" method="post" class="form-horizontal">{% csrf_token %}
        {{ variant_form.management_form }}
        {% for form in variant_form %}
        {{ form }}
        {% empty %}
        {% endfor %}
        <div class="form-actions">
            <button type="submit" class="btn btn-primary">Save</button>
        </div>
    </form>
</div>
{% endblock %}


{% block js %}
<script src="{{ STATIC_URL }}emberjs/js/ember-complete.js"></script>
<script>
$(document).ready(function(){

    App = Em.Application.create();

    var newPropView = Ember.TextField.create({
        id: 'input-new-prop',
        value: '',
    });

    var customPropsView = Ember.Select.create({
        id: 'custom-props',
        classNames: [''],
        content: [{% for property in object.data.options %}{'name':'{{ property.name }}','value':'{{ property.name }}','selected':false},{% endfor %}{'name': '--------', 'value': void 0, 'selected': false},{'name': '{% trans "Custom" %}', 'value': 'new', 'selected': false},],
        optionLabelPath: 'content.name',
        optionValuePath: 'content.value',
        change: function(event) {
            if (event != 'undefined') {
                newPropView.remove();
                if (event.srcElement.options[event.srcElement.options.selectedIndex].text == '--------') {
                    newPropView.appendTo('div#new-prop');
                } else if (event.srcElement.options[event.srcElement.options.selectedIndex].text == '{% trans "Custom" %}') {
                    newPropView.appendTo('div#new-prop');
                }
            }

        }
    });

    customPropsView.appendTo('label#wrap-custom-props');
});
</script>
{% endblock %}
