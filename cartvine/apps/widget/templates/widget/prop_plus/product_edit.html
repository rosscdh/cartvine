{% extends 'widget/widget_edit.html' %}
{% load i18n templatetag_handlebars %}
{% load url from future %}

{% block title %}{% trans 'Info for' %} {{ object.name }}{% endblock %}

{% block content-head %}
<h1>{% trans 'Properties for ' %}{{ object.name }}</h1>
{% endblock %}

{% block body %}
<h2>{% trans 'Properties' %}</h2>

<table class="table table-bordered">
<tr>
    <td class="span3"><strong>{% trans 'Title' %}</strong></td><td>{{ object.name }}</td>
</tr>
<tr>
    <td class="span3"><strong>{% trans 'Type' %}</strong></td><td>{{ object.product_type }}</td>
</tr>
<tr>
    <td class="span3"><strong>{% trans 'Vendor' %}</strong></td><td>{{ object.data.vendor }}</td>
</tr>
<tr>
    <td class="span3"><strong>{% trans 'Inventory' %}</strong></td><td>{{ object.data.inventory_quantity|default:"&infin;" }}</td>
</tr>
<table>

<h2>{% trans 'Tags' %}</h2>
<ul>
{% for tag in object.tags %}
    <li>{{ tag }}</li>
{% empty %}
    <li>None Configured</li>
{% endfor %}
</ul>

<h2>{% trans 'Custom Properties' %}</h2>
<ul>
{% for property in object.data.options %}
    <li>{{ property.name }}</li>
{% empty %}
    <li>None Configured</li>
{% endfor %}
</ul>
<!--     <p class="pull-right"><a class="btn btn-inverse" href="{% url 'widget:custom_config' slug=widget_slug %}">{% trans 'Add Properties' %}</a></p>
<div clas="clearfix">&nbsp;</div> -->

<form action="{% url 'widget:custom_apply_post' slug=widget_slug provider_pk=provider_pk %}" method="post" class="form-horizontal">{% csrf_token %}
    <table class="table table-bordered">
    <tr>
        <td class="span3"><label id="wrap-custom-props" for="input-new-prop"></label></td><td><div id="new-prop"></div></td>
    </tr>
    <table>
<!--         {{ form.management_form }}
    {% for form_item in form %}
    {{ form_item.name }}
    <div class="control-group">
        <label class="control-label" for="{{ form_item.value.auto_id }}">{{ form_item.name.value }}</label>
        <div class="controls">
            {{ form_item.value }}
        </div>
    </div>
    {% empty %}
        {% trans 'No Properties Configured' %}
    {% endfor %}
    <div class="form-actions">
        <button type="submit" class="btn btn-primary">Save</button>
    </div> -->
</form>


<h2>{% trans 'Inventory' %}</h2>
<div class="row">
Your customers will select this new variant by the following:
</div>
<div class="">
<form action="{% url 'widget:custom_apply_post' slug=widget_slug provider_pk=provider_pk %}" method="post" class="form-horizontal">{% csrf_token %}
    {{ variant_form.management_form }}
    {% for form in variant_form %}
    <div class="well">
        <div class="row">
            properties here
        </div>
        <div class="form-actions'">&nbsp;</div>
        <div class="row">
            <div class="span3">
            {{ form.sku.label|upper }}
            {{ form.sku }}
            </div>
            <div class="span2">
            {{ form.price.label }}
            {{ form.price }}
            </div>
            <div class="span3">
            {{ form.compare_at_price.label }}
            {{ form.compare_at_price }}
            </div>
            <div class="span2">
            {{ form.grams.label }}
            {{ form.grams }}
            </div>
        </div>
        <div class="row">
            <div class="span2">
            {{ form.taxable.label }}
            {{ form.taxable }}
            <br/>
            {{ form.requires_shipping.label }}
            {{ form.requires_shipping }}
            <br/>
            {{ form.inventory_management.label }}
            {{ form.inventory_management }}
            
            </div>
        </div>
    </div>
    <p>&nbsp;</p>
    {% empty %}
    {% endfor %}
    <div class="form-actions">
        <button type="submit" class="btn btn-primary">Save</button>
    </div>
</form>
</div>

{% endblock %}


{% block js %}
<script src="{{ STATIC_URL }}emberjs/js/ember-complete.js"></script>
<script>
$(document).ready(function(){

    App = Em.Application.create();

    var newPropView = Ember.TextField.create({
        id: 'input-new-prop',
        value: '',
        placeholder: '{% trans "Default value" %}',
    });

    var buttonAddView = Ember.Button.create({
        id: 'button-add-new-prop',
        value: '{% trans "Add" %}',
        text: 'fdasfd',
        classNames: ['btn', 'btn-success', 'icon-plus-sign', 'icon-white'],
    });

    var customPropsView = Ember.Select.create({
        id: 'custom-props',
        classNames: [''],
        content: [{% for property in object.data.options %}{'name':'{{ property.name }}','value':'{{ property.name }}','selected':false},{% endfor %}{'name': '--------', 'value': void 0, 'selected': false},{'name': '{% trans "Custom" %}', 'value': 'new', 'selected': false},],
        optionLabelPath: 'content.name',
        optionValuePath: 'content.value',
        change: function(event) {
            if (event != 'undefined') {
                newPropView.remove();
                buttonAddView.remove();
                if (event.srcElement.options[event.srcElement.options.selectedIndex].text == '--------') {
                    newPropView.appendTo('div#new-prop');
                    buttonAddView.appendTo('div#new-prop');
                } else if (event.srcElement.options[event.srcElement.options.selectedIndex].text == '{% trans "Custom" %}') {
                    newPropView.appendTo('div#new-prop');
                    buttonAddView.appendTo('div#new-prop');
                }
            }

        }
    });

    customPropsView.appendTo('label#wrap-custom-props');
});
</script>
{% endblock %}
